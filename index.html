<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>물타기 계산기 - 미국주식 & 한국주식</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="background-overlay"></div>
    
    <header class="header">
        <div class="header-content">
            <h1 class="logo">
                <i class="fas fa-chart-line"></i>
                물타기 계산기
            </h1>
            <p class="subtitle">전문가용 투자 분석 도구</p>
            <div id="exchange-rate" class="exchange-rate-display">
                <span class="currency-change" id="usd-krw-change"></span>
                <div class="rate-info">
                    <span class="currency-label">USD/KRW:</span>
                    <span class="currency-value" id="usd-krw-rate">loading...</span>
                </div>
            </div>
        </div>
    </header>

    <main class="main-container">
        <div class="calculator-wrapper">
            <div class="tabs">
                <button class="tab-btn active" data-tab="us-stock">
                    <i class="fas fa-flag-usa"></i>
                    미국주식
                </button>
                <button class="tab-btn" data-tab="kr-stock">
                    <i class="fas fa-flag"></i>
                    한국주식
                </button>
            </div>

            <!-- 미국주식 계산기 -->
            <div class="tab-content active" id="us-stock">
                <div class="calculator-section">
                    <h2 class="section-title">미국주식 물타기 계산</h2>
                    
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="us-current-shares">현재 보유 수량 (주)</label>
                            <input type="number" id="us-current-shares" placeholder="예: 100" step="1">
                        </div>
                        
                        <div class="input-group">
                            <label for="us-current-price">현재 평균 단가 ($)</label>
                            <input type="number" id="us-current-price" placeholder="예: 150.50" step="0.01">
                        </div>
                        
                        <div class="input-group">
                            <label for="us-market-price">현재 시가 ($)</label>
                            <input type="number" id="us-market-price" placeholder="예: 120.00" step="0.01">
                        </div>
                        
                        <div class="input-group">
                            <label for="us-additional-shares">추가 매수 수량 (주)</label>
                            <input type="number" id="us-additional-shares" placeholder="예: 50" step="1">
                        </div>
                        
                        <div class="input-group">
                            <label for="us-additional-price">추가 매수 희망가 ($)</label>
                            <input type="number" id="us-additional-price" placeholder="예: 100.00" step="0.01">
                        </div>

                    </div>
                    
                    <button class="calculate-btn" onclick="calculateUSStock()">
                        <i class="fas fa-calculator"></i>
                        계산하기
                    </button>
                </div>
            </div>

            <!-- 한국주식 계산기 -->
            <div class="tab-content" id="kr-stock">
                <div class="calculator-section">
                    <h2 class="section-title">한국주식 물타기 계산</h2>
                    
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="kr-current-shares">현재 보유 수량 (주)</label>
                            <input type="number" id="kr-current-shares" placeholder="예: 100" step="1">
                        </div>
                        
                        <div class="input-group">
                            <label for="kr-current-price">현재 평균 단가 (₩)</label>
                            <input type="number" id="kr-current-price" placeholder="예: 150,000" step="100">
                        </div>
                        
                        <div class="input-group">
                            <label for="kr-market-price">현재 시가 (₩)</label>
                            <input type="number" id="kr-market-price" placeholder="예: 120,000" step="100">
                        </div>
                        
                        <div class="input-group">
                            <label for="kr-additional-shares">추가 매수 수량 (주)</label>
                            <input type="number" id="kr-additional-shares" placeholder="예: 50" step="1">
                        </div>
                        
                        <div class="input-group">
                            <label for="kr-additional-price">추가 매수 희망가 (₩)</label>
                            <input type="number" id="kr-additional-price" placeholder="예: 100,000" step="100">
                        </div>

                    </div>
                    
                    <button class="calculate-btn" onclick="calculateKRStock()">
                        <i class="fas fa-calculator"></i>
                        계산하기
                    </button>
                </div>
            </div>
        </div>

        <!-- 계산 결과 -->
        <div class="results-section" id="results" style="display: none;">
            <div class="results-header">
                <h2>투자 분석 결과</h2>
                <button class="close-btn" onclick="hideResults()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- 핵심 지표 요약 -->
            <div class="summary-cards">
                <div class="summary-card primary">
                    <div class="summary-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="summary-content">
                        <h3>손익 개선</h3>
                        <div class="summary-value" id="improvement-display">-</div>
                        <div class="summary-change" id="improvement-change">-</div>
                    </div>
                </div>
                
                <div class="summary-card secondary">
                    <div class="summary-icon">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <div class="summary-content">
                        <h3>신규 평균단가</h3>
                        <div class="summary-value" id="avg-price-display">-</div>
                        <div class="summary-desc">물타기 후</div>
                    </div>
                </div>
                
                <div class="summary-card tertiary">
                    <div class="summary-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="summary-content">
                        <h3>손절가</h3>
                        <div class="summary-value" id="stop-loss-display">-</div>
                        <div class="summary-desc">리스크 관리</div>
                    </div>
                </div>
            </div>

            <!-- 상세 분석 -->
            <div class="results-grid">
                <div class="result-card">
                    <h3>현재 상황 분석</h3>
                    <div class="result-item">
                        <span class="label">총 보유 수량:</span>
                        <span class="value" id="total-shares-before">-</span>
                    </div>
                    <div class="result-item">
                        <span class="label">평균 단가:</span>
                        <span class="value" id="avg-price-before">-</span>
                    </div>
                    <div class="result-item">
                        <span class="label">현재 손익:</span>
                        <span class="value" id="current-pl">-</span>
                    </div>
                    <div class="result-item" id="krw-converted-before" style="display: none;">
                        <span class="label">원화 환산액:</span>
                        <span class="value" id="total-value-krw-before">-</span>
                    </div>
                    <div class="result-item">
                        <span class="label">수익률:</span>
                        <span class="value" id="current-return">-</span>
                    </div>
                </div>

                <div class="result-card">
                    <h3>물타기 후 분석</h3>
                    <div class="result-item">
                        <span class="label">총 보유 수량:</span>
                        <span class="value" id="total-shares-after">-</span>
                    </div>
                    <div class="result-item">
                        <span class="label">신규 평균 단가:</span>
                        <span class="value" id="avg-price-after">-</span>
                    </div>
                    <div class="result-item" id="krw-converted-after" style="display: none;">
                        <span class="label">원화 환산액:</span>
                        <span class="value" id="total-value-krw-after">-</span>
                    </div>
                    <div class="result-item">
                        <span class="label">손절가:</span>
                        <span class="value" id="stop-loss">-</span>
                    </div>
                </div>

                <div class="result-card">
                    <h3>투자 인사이트</h3>
                    <div class="result-item">
                        <span class="label">총 투자금:</span>
                        <span class="value" id="total-investment">-</span>
                    </div>
                    <div class="result-item">
                        <span class="label">회복까지 필요한 상승률:</span>
                        <span class="value" id="recovery-rate">-</span>
                    </div>
                    <div class="result-item">
                        <span class="label">손익 개선:</span>
                        <span class="value" id="improvement">-</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <p>&copy; 2024 주식 물타기 계산기. 투자에 대한 모든 책임은 투자자 본인에게 있습니다.</p>
    </footer>

    <script src="js/dashboard.js"></script>
    <script src="js/calculator.js"></script>
</body>
</html>